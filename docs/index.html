<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Building and training custom neural networks in the typical R syntax. The torch package is used for numerical calculations, which allows for training on CPU as well as on a graphics card. ">
<title>Building and Training Neural Networks • cito</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Building and Training Neural Networks">
<meta property="og:description" content="Building and training custom neural networks in the typical R syntax. The torch package is used for numerical calculations, which allows for training on CPU as well as on a graphics card. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">cito</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/A-Introduction_to_cito.html">Introduction to cito</a>
    <a class="dropdown-item" href="articles/B-Training_neural_networks.html">Training neural networks</a>
    <a class="dropdown-item" href="articles/C-Example_Species_distribution_modeling.html">Example: (Multi-) Species distribution models with cito</a>
    <a class="dropdown-item" href="articles/D-Advanced_custom_loss_functions.html">Advanced: Custom loss functions and prediction intervals</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/citoverse/cito/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="cito">cito<a class="anchor" aria-label="anchor" href="#cito"></a>
</h1></div>
<p><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a> <a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/License-GPL%20v3-blue.svg" alt="License: GPL v3"></a> <a href="https://cran.r-project.org/package=cito" class="external-link"><img src="http://www.r-pkg.org/badges/version/cito" alt="CRAN_Status_Badge"></a> <a href="https://github.com/citoverse/cito/actions" class="external-link"><img src="https://github.com/citoverse/cito/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></p>
<!-- badges: end -->
<p>‘cito’ simplifies the building and training of (deep) neural networks by relying on standard R syntax and familiar methods from statistical packages. Model creation and training can be done with a single line of code. Furthermore, all generic R methods such as print or plot can be used on the fitted model. At the same time, ‘cito’ is computationally efficient because it is based on the deep learning framework ‘torch’ (with optional GPU support). The ‘torch’ package is native to R, so no Python installation or other API is required for this package.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Before installing ‘cito’ make sure ‘torch’ is installed. See the code chunk below if you are unsure on how to check this</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check package </span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://torch.mlverse.org/docs" class="external-link">'torch'</a></span>,quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'torch'</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://torch.mlverse.org/docs" class="external-link">'torch'</a></span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#install torch</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/torch/man/torch_is_installed.html" class="external-link">torch_is_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/torch/man/install_torch.html" class="external-link">install_torch</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>If you have trouble installing ‘torch’, please <a href="https://torch.mlverse.org/docs/articles/installation.html" class="external-link">visit their website</a> or create an issue on <a href="https://github.com/citoverse/cito/issues" class="external-link">our github website</a>. We are happy to help.</p>
<p>A stable version of cito from CRAN can be installed with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"cito"</span><span class="op">)</span></span></code></pre></div>
<p>The development version from <a href="https://github.com/" class="external-link">GitHub</a> is available with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">'devtools'</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'devtools'</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'citoverse/cito'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Once installed, the main function <code><a href="reference/dnn.html">dnn()</a></code> can be used. See the example below. A more in depth explanation can be found in the vignettes.</p>
<ol style="list-style-type: decimal">
<li>Fit model with bootstrapping (for uncertainties)</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://citoverse.github.io/cito/" class="external-link">cito</a></span><span class="op">)</span></span>
<span><span class="va">nn.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dnn.html">dnn</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/iris.html" class="external-link">iris</a></span>, bootstrap <span class="op">=</span> <span class="fl">30L</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Check if models have converged (compare training loss against baseline loss (=intercept only model)):</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/analyze_training.html">analyze_training</a></span><span class="op">(</span><span class="va">nn.fit</span><span class="op">)</span></span>
<span><span class="co"># At 1st glance they are converged since the loss is lower than the baseline loss.</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Plot model architecture</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nn.fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-7-1.png"><!-- --></p>
<ol start="4" style="list-style-type: decimal">
<li>Return xAI effects and their uncertainties:</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nn.fit</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="do">## Summary of Deep Neural Network Model</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="do">##  ##########################################################</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="do">##      Feature Importance </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="do">##  ##########################################################</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="do">##                          Importance Std.Err Z value Pr(&gt;|z|)    </span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="do">## Response_1: Sepal.Width       1.815   0.557    3.26  0.00113 ** </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="do">## Response_1: Petal.Length     19.211   5.563    3.45  0.00055 ***</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="do">## Response_1: Petal.Width       0.485   0.475    1.02  0.30690    </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="do">## Response_1: Species           0.459   0.277    1.65  0.09826 .  </span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="do">##  ##########################################################</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="do">##      Average Conditional Effects </span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="do">##  ##########################################################</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="do">##                              ACE Std.Err Z value Pr(&gt;|z|)    </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="do">## Response_1: Sepal.Width   0.7125  0.0791    9.01   &lt;2e-16 ***</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="do">## Response_1: Petal.Length  0.6436  0.0664    9.70   &lt;2e-16 ***</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="do">## Response_1: Petal.Width  -0.1560  0.1360   -1.15     0.25    </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="do">##  ##########################################################</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="do">##      Standard Deviation of Conditional Effects </span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="do">##  ##########################################################</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="do">##                             ACE Std.Err Z value Pr(&gt;|z|)    </span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="do">## Response_1: Sepal.Width  0.1466  0.0430    3.41  0.00064 ***</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="do">## Response_1: Petal.Length 0.1271  0.0411    3.09  0.00200 ** </span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="do">## Response_1: Petal.Width  0.0487  0.0282    1.72  0.08482 .  </span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Predict (with confidence intervals):</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">nn.fit</span>, newdata <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/iris.html" class="external-link">iris</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="do">## [1]  30 150   1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="advanced">Advanced<a class="anchor" aria-label="anchor" href="#advanced"></a>
</h2>
<p>We can also pass custom loss functions to ‘cito’, and we can use additional parameters within the custom loss function. The only requirement is that all calculations must be written using the ‘torch’ package (cito automatically converts the initial values for the custom parameters to ‘torch’ objects).</p>
<p>We use a multivariate normal distribution as the likelihood function and we want to parameterize/fit the covariance matrix of the multivariate normal distribution:</p>
<ol style="list-style-type: decimal">
<li><p>We need one helper function, <code>create_cov()</code> that builds the covariance matrix based on a LU and the diagonals</p></li>
<li><p>We need our custom likelihood function which uses the <code>distr_multivariate_normal(…)</code> function from the torch package:</p></li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">create_cov</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">LU</span>, <span class="va">Diag</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">torch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/torch/man/torch_matmul.html" class="external-link">torch_matmul</a></span><span class="op">(</span><span class="va">LU</span>, <span class="va">LU</span><span class="op">$</span><span class="fu">t</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">torch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/torch/man/torch_diag.html" class="external-link">torch_diag</a></span><span class="op">(</span><span class="va">Diag</span><span class="op">+</span><span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">custom_loss_MVN</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">true</span>, <span class="va">pred</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Sigma</span> <span class="op">=</span> <span class="fu">create_cov</span><span class="op">(</span><span class="va">SigmaPar</span>, <span class="va">SigmaDiag</span><span class="op">)</span></span>
<span>  <span class="va">logLik</span> <span class="op">=</span> <span class="fu">torch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/torch/man/distr_multivariate_normal.html" class="external-link">distr_multivariate_normal</a></span><span class="op">(</span><span class="va">pred</span>,</span>
<span>                                            covariance_matrix <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">log_prob</span><span class="op">(</span><span class="va">true</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="va">logLik</span><span class="op">$</span><span class="fu">mean</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>We use “SigmaPar” and “SigmaDiag” as parameters that we want to optimize along the DNN. We will pass a named list with starting values to ‘cito’ and ‘cito’ will infer automatically (based on the R shape) the shape of the parameters:</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nn.fit</span><span class="op">&lt;-</span> <span class="fu"><a href="reference/dnn.html">dnn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, <span class="va">Petal.Length</span><span class="op">)</span><span class="op">~</span><span class="va">.</span>,</span>
<span>             data <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/iris.html" class="external-link">iris</a></span>,</span>
<span>             lr <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>             epochs <span class="op">=</span> <span class="fl">200L</span>,</span>
<span>             loss <span class="op">=</span> <span class="va">custom_loss_MVN</span>,</span>
<span>             verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             custom_parameters <span class="op">=</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>SigmaDiag <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="co"># Our parameters with starting values</span></span>
<span>                    SigmaPar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span>, sd <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># Our parameters with starting values</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Estimated covariance matrix:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">create_cov</span><span class="op">(</span><span class="va">nn.fit</span><span class="op">$</span><span class="va">loss</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">SigmaPar</span>,</span>
<span>                     <span class="va">nn.fit</span><span class="op">$</span><span class="va">loss</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">SigmaDiag</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="do">##            [,1]       [,2]       [,3]</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="do">## [1,] 0.23374167 0.07131696 0.13503927</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="do">## [2,] 0.07131696 0.09627343 0.03110428</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="do">## [3,] 0.13503927 0.03110428 0.19582744</span></span></code></pre></div>
<p>Empirical covariance matrix:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">nn.fit</span><span class="op">)</span> <span class="op">-</span> <span class="va">nn.fit</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="do">##              Sepal.Length Sepal.Width Petal.Length</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="do">## Sepal.Length   0.22601251  0.05944633   0.12786447</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="do">## Sepal.Width    0.05944633  0.09067426   0.01754041</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="do">## Petal.Length   0.12786447  0.01754041   0.14744435</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=cito" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/citoverse/cito/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/citoverse/cito/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cito</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Christian Amesöder <br><small class="roles"> Author </small>  </li>
<li>Maximilian Pichler <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2252-8327" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Christian Amesöder, Maximilian Pichler.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
